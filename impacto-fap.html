<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Como o FAP é calculado — Guia visual e interativo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Tailwind apenas nesta página -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'tax-blue': '#152E3E',
            'tax-gold': '#E2B874',
            'tax-gray': '#EBEBEB',
            'tax-dark-gray': '#6B7280',
            'tax-bg-light': '#F9FAFB',
          }
        }
      }
    }
  </script>

  <!-- Estilos do menu e da página -->
  <style>
    html,body{ margin:0; padding:0 } /* remove espaço branco no topo */
    .navtab{
      padding:.5rem .9rem; border-radius:999px; border:1px solid transparent;
      color:#fff; background:rgba(255,255,255,.06); display:inline-block
    }
    .navtab:hover{ background:rgba(255,255,255,.12) }
    .navtab.is-active{ border-color:#E2B874; background:rgba(226,184,116,.12); color:#fff }

    #calc-impacto-fap { background-color: #152E3E; }
    #calc-impacto-fap .main-card{
      background:#fff; border-radius:.75rem;
      box-shadow:0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1)
    }
    #calc-impacto-fap .input-field{
      background:#F3F4F6; border:1px solid #D1D5DB;
      border-radius:.5rem; transition:all .2s ease-in-out; color:#152E3E
    }
    #calc-impacto-fap .input-field:focus,
    #calc-impacto-fap .input-field:focus-within{
      border-color:#E2B874; box-shadow:0 0 0 2px rgba(226,184,116,.3); outline:none
    }
    #calc-impacto-fap input[type=number]::-webkit-inner-spin-button,
    #calc-impacto-fap input[type=number]::-webkit-outer-spin-button{ -webkit-appearance:none; margin:0 }
    #calc-impacto-fap input[type=number]{ -moz-appearance:textfield }
  </style>
</head>
<body class="bg-tax-blue">

  <!-- NAV entre as 3 páginas -->
  <div class="bg-tax-blue">
    <nav class="container mx-auto max-w-4xl flex justify-center gap-2 py-3">
      <!-- use links RELATIVOS; os três arquivos devem estar na MESMA pasta -->
      <a href="./index.html"                  class="navtab">Calculadora</a>
      <a href="./impactos-fap.html"           class="navtab">Impactos do FAP</a>
      <a href="./como-o-fap-e-calculado.html" class="navtab">Como o FAP é calculado</a>
    </nav>
  </div>

  <section id="calc-impacto-fap" class="text-gray-800">
    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">

      <!-- TÍTULO -->
      <header class="text-center mb-10">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-white">Como o FAP é calculado</h1>
        <p class="mt-2 text-lg sm:text-xl text-tax-gold">Guia visual e interativo</p>
      </header>

      <!-- (conteúdo existente da página permanece) -->
      <div class="main-card overflow-hidden">
        <div class="p-6 sm:p-8 bg-tax-bg-light border-b border-tax-gray">
          <h2 class="text-xl font-bold text-tax-blue mb-6">1. Insira os dados da sua empresa</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
              <label for="rat" class="block text-sm font-medium text-tax-dark-gray mb-1">Alíquota RAT (%)</label>
              <select id="rat" class="w-full p-3 input-field">
                <option value="1">1% (Leve)</option>
                <option value="2">2% (Médio)</option>
                <option value="3">3% (Grave)</option>
              </select>
            </div>
            <div>
              <label for="fap" class="block text-sm font-medium text-tax-dark-gray mb-1">Índice FAP Atual</label>
              <input type="text" id="fap" value="1,0000" inputmode="decimal" placeholder="1,0000" class="w-full p-3 input-field">
              <p class="text-xs text-tax-dark-gray mt-1">Use vírgula: ex. 0,7500</p>
            </div>
            <div>
              <label for="folha" class="block text-sm font-medium text-tax-dark-gray mb-1">Folha de Pagamento Mensal</label>
              <div class="relative">
                <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-tax-dark-gray pointer-events-none">R$</span>
                <input type="text" id="folha" inputmode="decimal" placeholder="50.000,00" class="w-full p-3 pl-10 text-right input-field">
              </div>
              <p class="text-xs text-tax-dark-gray mt-1">Informe a folha média em reais</p>
            </div>
          </div>
        </div>

        <div class="p-6 sm:p-8 bg-white">
          <h2 class="text-xl font-bold text-tax-blue mb-8">2. Analise o Resultado</h2>

          <div class="bg-tax-blue rounded-lg p-6 text-center mb-8">
            <p class="text-lg font-semibold text-white">Custo Adicional em 26 Meses</p>
            <p class="text-sm text-tax-gray mb-3">(Diferença entre seu FAP atual e o FAP mínimo)</p>
            <p id="impacto-total" class="text-4xl sm:text-5xl font-bold text-tax-gold">R$ 0,00</p>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
            <div>
              <p class="text-sm text-tax-dark-gray">RAT Ajustado</p>
              <p id="rat-ajustado" class="text-2xl font-bold text-tax-blue">1,0000%</p>
            </div>
            <div>
              <p class="text-sm text-tax-dark-gray">Custo Mensal (FAP Atual)</p>
              <p id="custo-atual" class="text-2xl font-bold text-red-600">R$ 0,00</p>
            </div>
            <div>
              <p class="text-sm text-tax-dark-gray">Custo Mensal (FAP Mínimo)</p>
              <p id="custo-minimo" class="text-2xl font-bold text-green-600">R$ 0,00</p>
            </div>
          </div>
          <p class="mt-8 text-center text-xs text-gray-500">*Estimativa considerando 24 salários + 2x décimo terceiro.</p>
        </div>
      </div>

      <footer class="text-center mt-8 text-sm text-gray-300">
        <p>Simulador desenvolvido para fins de estimativa. Os valores podem variar.</p>
      </footer>

    </div>
  </section>

  <!-- Script do menu: marca a aba ativa (robusto para subpastas) -->
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      var tabs = document.querySelectorAll('.navtab');

      function norm(p){
        try { p = new URL(p, location.href).pathname; }  // usa a URL atual como base
        catch(e) { p = p || ''; }
        return p.replace(/\/index\.html?$/i,'/').replace(/\/+$/,'');
      }

      var here = norm(location.pathname);
      tabs.forEach(function(a){
        var target = norm(a.getAttribute('href') || '');
        if (target && here === target) a.classList.add('is-active');
      });
    });
  </script>

  <!-- Cálculo Impacto FAP x RAT -->
  <script>
    const ratInput = document.getElementById('rat');
    const fapInput = document.getElementById('fap');
    const folhaInput = document.getElementById('folha');

    const ratAjustadoOutput = document.getElementById('rat-ajustado');
    const custoMinimoOutput = document.getElementById('custo-minimo');
    const custoAtualOutput = document.getElementById('custo-atual');
    const impactoTotalOutput = document.getElementById('impacto-total');

    function formatToCurrencyDisplay(value) {
      return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    }
    function parseCurrencyToNumber(value) {
      if (typeof value !== 'string' || value === '') return 0;
      return parseFloat(value.replace(/\./g, '').replace(',', '.'));
    }
    function formatCurrencyInput(event) {
      const input = event.target;
      let value = input.value.replace(/\D/g, '');
      if (value === '') { input.value = ''; return; }
      const numberValue = parseFloat(value) / 100;
      input.value = numberValue.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }
    function parseFap(str){
      if (typeof str !== 'string') return 0;
      return parseFloat(str.replace(/\./g,'').replace(',', '.')) || 0;
    }

    function calcularImpacto() {
      const rat = parseFloat(ratInput.value) || 1;
      const fap = parseFap(fapInput.value);
      const folha = parseCurrencyToNumber(folhaInput.value) || 0;
      const fapMinimo = 0.5000;

      const ratAjustado = rat * fap;
      const custoAtual = folha * (ratAjustado / 100);
      const custoMinimo = folha * ((rat * fapMinimo) / 100);
      const impacto26Meses = (custoAtual - custoMinimo) * 26;

      ratAjustadoOutput.textContent = `${ratAjustado.toFixed(4).replace('.', ',')}%`;
      custoMinimoOutput.textContent = formatToCurrencyDisplay(custoMinimo);
      custoAtualOutput.textContent = formatToCurrencyDisplay(custoAtual);
      impactoTotalOutput.textContent = formatToCurrencyDisplay(impacto26Meses);
    }

    ratInput.addEventListener('input', calcularImpacto);
    fapInput.addEventListener('input', () => calcularImpacto());
    folhaInput.addEventListener('input', (e) => { formatCurrencyInput(e); calcularImpacto(); });
    document.addEventListener('DOMContentLoaded', calcularImpacto);
  </script>

</body>
</html>
